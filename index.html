<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>訃聞資料</title>
    <link rel="stylesheet" href="invitation.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick-theme.css">
</head>
<body>
    <header>
        <img src="image/logo.png" alt="祥安生命有限公司 Logo" class="logo">
    </header>
    <main>
        <section id="main-photo-section">
            <h2>主照片</h2>
            <img id="main-photo" alt="主照片">
        </section>

        <section id="additional-photos-section">
            <h2>其他照片</h2>
            <div class="carousel" id="additional-photos"></div>
        </section>
    </main>
    <footer>
        <p>&copy; 2024 祥安生命有限公司. 版權所有.</p>
    </footer>
    <audio id="background-music" loop>
        <source src="audio/default-music.mp3" type="audio/mp3">
        您的瀏覽器不支持音頻元素。
    </audio>
    <button id="play-music">🔊</button>
    <button id="stop-music" style="display: none;">🔇</button>

    <script src="https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const mainPhoto = document.getElementById('main-photo');
            const additionalPhotosContainer = document.getElementById('additional-photos');
            const backgroundMusic = document.getElementById('background-music');
            const playMusicButton = document.getElementById('play-music');
            const stopMusicButton = document.getElementById('stop-music');

            // 读取并显示主照片
            const mainPhotoUrl = localStorage.getItem('mainPhoto');
            if (mainPhotoUrl) {
                mainPhoto.src = mainPhotoUrl;
            }

            // 读取并显示附加照片
            const additionalPhotos = JSON.parse(localStorage.getItem('additionalPhotos')) || [];
            additionalPhotos.forEach(photoDataUrl => {
                const img = document.createElement('img');
                img.src = photoDataUrl;
                additionalPhotosContainer.appendChild(img);
            });

            // 初始化 Slick Carousel
            $('.carousel').slick({
                dots: true,
                infinite: true,
                speed: 500,
                slidesToShow: 1,
                slidesToScroll: 1
            });

            // 播放音乐
            playMusicButton.addEventListener('click', () => {
                backgroundMusic.play().catch(error => console.error("播放背景音乐失败", error));
                playMusicButton.style.display = 'none';
                stopMusicButton.style.display = 'inline';
            });

            // 停止音乐
            stopMusicButton.addEventListener('click', () => {
                backgroundMusic.pause();
                playMusicButton.style.display = 'inline';
                stopMusicButton.style.display = 'none';
            });

            // 音乐播放控制
            function loadStoredSettings() {
                const storedMusicUrl = localStorage.getItem('musicUrl');
                const isMusicPlaying = localStorage.getItem('musicPlaying') === 'true';

                if (storedMusicUrl) {
                    backgroundMusic.src = storedMusicUrl;
                    if (isMusicPlaying) {
                        backgroundMusic.play().catch(error => {
                            console.error("播放背景音乐失败:", error);
                        });
                        playMusicButton.style.display = 'none';
                        stopMusicButton.style.display = 'inline';
                    }
                }
            }

            loadStoredSettings();
        });
    </script>
</body>
</html>
