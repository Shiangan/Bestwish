<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>訂購花籃</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <img src="logo.png" alt="祥安生命有限公司 Logo" class="logo">
        <h1>訂購花籃</h1>
    </header>

    <main>
        <section id="flower-basket-options">
            <h2>選擇花籃樣式</h2>
            <div class="flower-option" data-price="1000">
                <img src="standard-basket.jpg" alt="標準花籃">
                <h3>標準花籃</h3>
                <p>價格: $1000</p>
                <button class="add-to-cart" data-basket="standard">加入購物車</button>
            </div>
            <div class="flower-option" data-price="2000">
                <img src="premium-basket.jpg" alt="高級花籃">
                <h3>高級花籃</h3>
                <p>價格: $2000</p>
                <button class="add-to-cart" data-basket="premium">加入購物車</button>
            </div>
        </section>

        <section id="shopping-cart">
            <h3>購物車</h3>
            <ul id="cart-items"></ul>
            <p>總數量: <span id="total-quantity">0</span></p>
            <p>總金額: <span id="total-price">0</span></p>
        </section>
        
        <section id="order-details">
            <h3>填寫訂購資訊</h3>
            <form id="flower-order-form">
                <label for="sender-name">訂購人姓名:</label>
                <input type="text" id="sender-name" name="sender-name" required>
                
                <label for="recipient-name">收件人姓名:</label>
                <input type="text" id="recipient-name" name="recipient-name" required>
                
                <label for="recipient-address">收件地址:</label>
                <textarea id="recipient-address" name="recipient-address" required></textarea>
                
                <label for="invoice">是否需要發票:</label>
                <input type="checkbox" id="invoice" name="invoice">
                
                <label for="senders-names">聯名送花名單:</label>
                <textarea id="senders-names" name="senders-names"></textarea>
                
                <button type="submit">提交訂單</button>
            </form>
        </section>
    </main>

    <footer>
        <p>&copy; 2024 祥安生命有限公司. 版權所有.</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const orderForm = document.getElementById('flower-order-form');

            orderForm.addEventListener('submit', function(event) {
                event.preventDefault();
                const formData = new FormData(orderForm);

                // 將表單數據轉換為對象
                const orderData = {
                    senderName: formData.get('sender-name'),
                    recipientName: formData.get('recipient-name'),
                    recipientAddress: formData.get('recipient-address'),
                    needInvoice: formData.has('invoice'),
                    sendersNames: formData.get('senders-names'),
                    cartItems: JSON.parse(localStorage.getItem('cartItems')) || []
                };

                // 發送訂單數據到後端
                fetch('http://localhost:3000/api/orders', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(orderData),
                })
                .then(response => response.json())
                .then(data => {
                    console.log('訂單提交成功:', data.message);
                    localStorage.removeItem('cartItems'); // 清空購物車
                    alert('訂單已提交！');
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('訂單提交失敗，請稍後再試！');
                });
            });
        });
    </script>
</body>
</html>
